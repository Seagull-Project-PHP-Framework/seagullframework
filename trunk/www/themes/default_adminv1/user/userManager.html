<span flexy:if="msgGet()">{msgGet()}</span>

<form name="users" method="post" flexy:ignore id="users" action="{makeUrl(##,#user#,##)}">
    <fieldset id="userCommands">
        <legend>{translate(#Synchronize#)}</legend>
        <p>
            <label>{translate(#Role#)}</label>
            <select name="roleSync">
                <option value="null">{translate(#(each users current)#)}</option>
                {generateSelect(aRoles):h}
            </select>
        </p>
        <p>
            <label>{translate(#Mode#)}</label>
            <select name="roleSyncMode">
                {generateSelect(aSyncModes):h}
            </select>
        </p>
        <p>
            <label>&nbsp;</label>
            <input type="submit" name="syncToRole" value="{translate(#sync perms with role#)}"
                onclick="return confirmCustom('{translate(#You must select a user to sync#)}', '{translate(#Are you sure you want to sync this user(s)?#)}', 'users')" class="toolBtnSeparate" />
        </p>
    </fieldset>
    <fieldset class="main" id="userMain">
        
        <table class="full">
            <thead>
                <tr flexy:if="pager">
                    <td colspan="10">
                        <flexy:include src="pager.html" />
                    </td>
                </tr>
                <tr>
                    <td colspan="10" class="center">
                        {totalItems} {translate(#user(s) found#)}
                        {if:search}
                        <a href="{makeUrl(#search#,#usersearch#,#user#,##,#frmSortBy|sortBy||frmSortOrder|sortOrder#)}">{translate(#clear search#)}</a>
                        {end:}
                    </td>
                </tr>
                <tr>
                    <th class="id"><a href="{makeUrl(#list#,#user#,#user#,##,#frmSortBy|usr_id||frmSortOrder|sortOrder#)}">#</a></th>
                    <th class="select">
                        <span class="tipOwner">
                            <span class="tipText" id="becareful">Be Careful !</span>
                            <input type="checkbox" name="checkAll" id="checkAll" onclick="javascript:applyToAllCheckboxes('users', 'frmDelete[]', this.checked)" />
                        </span>
                    </th>
                    <th class="left"><a href="{makeUrl(#list#,#user#,#user#,##,#frmSortBy|username||frmSortOrder|sortOrder#)}">{translate(#Username#)}</a></th>
                    {if:conf[OrgMgr][enabled]}
                    <th>{translate(#Organisation#)}</th>
                    {end:}
                    <th class="left">{translate(#Email#)}</th>
                    <th>{translate(#Role#)}</th>
                    <th><a href="{makeUrl(#list#,#user#,#user#,##,#frmSortBy|is_acct_active||frmSortOrder|sortOrder#)}">{translate(#Status#)}</a></th>
                    <th>{translate(#Edit#)}</th>
                    <th>{translate(#Password#)}</th>
                    <th>{translate(#Permissions#)}</th>
                    <th>{translate(#Logins#)}</th>
                </tr>
            </thead>
            <tfoot>
                <tr valign="middle">
                    <td>&nbsp;</td>
                    <td class="right">
                        <img src="{webRoot}/themes/{theme}/images/16/arrow_right.png" alt="" />
                    </td>
                    <td colspan="8">{translate(#With selected user(s)#)}: <input type="submit" name="delete" value="{translate(#delete#)}" onclick="return confirmSubmit('{translate(#user#)}', 'users')" />
                    </td>
                </tr>
                
                <tr flexy:if="pager">
                    <td colspan="10">
                        <flexy:include src="pager.html" />
                    </td>
                </tr>
            </tfoot>
            <tbody>
                <tr class="{switchRowClass()}" flexy:foreach="aPagedData[data],key,aValue">
                    <td>{aValue[usr_id]}</td>
                    <td><input type="checkbox" name="frmDelete[]" value="{aValue[usr_id]}" /></td>
                    <td class="left">{aValue[username]}</td>
                    {if:conf[OrgMgr][enabled]}
                    <td>{aValue[org_name]}</td>
                    {end:}
                    <td class="left">{aValue[email]}</td>
                    <td>{aValue[role_name]}</td>
                    <td>
                        {if:aValue[is_acct_active]}<a href="{makeUrl(#requestChangeUserStatus#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}"><img src="{webRoot}/themes/{theme}/images/16/status_enabled.gif" alt="{translate(#Active#)}" title="{translate(#Change status#)}" /> </a>
                        {else:} <a href="{makeUrl(#requestChangeUserStatus#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}"><img src="{webRoot}/themes/{theme}/images/16/status_disabled.gif" alt="{translate(#Disabled#)}" title="{translate(#Change status#)}" /></a>
                        {end:}
                    </td>
                    <td>
                        <a href="{makeUrl(#edit#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}">
                            <img src="{webRoot}/themes/{theme}/images/edit.gif" alt="{translate(#edit#)}" />
                        </a>
                    </td>
        
                    <td>
                        <input type="button" name="frmReset" value="{translate(#reset#)}"
                            onclick="javascript:document.location.href='{makeUrl(#requestPasswordReset#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}'" />
                    </td>
                    <td flexy:if="!isAdmin(aValue[role_id])">
                        <input type="button" name="frmReset" value="{translate(#change#)}"
                            onClick="javascript:document.location.href='{makeUrl(#editPerms#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}'" />
                    </td>
                    <td flexy:if="isAdmin(aValue[role_id])">&nbsp;</td>
                    <td ><a href="{makeUrl(#viewLogin#,#user#,##,aPagedData[data],#frmUserID|usr_id#,key)}">list</a></td>
                </tr>
                <tr flexy:if="!aPagedData[data]">
                    <td colspan="10">&nbsp;</td>
                </tr>
            </tbody>
        </table>
    </fieldset>
    <div class="spacer"></div>
</form>
