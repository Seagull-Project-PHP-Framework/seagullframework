<script type="text/javascript">
function addFormValue(myElement, form)
{
    var myForm = document.getElementById(form);
    
    newInput = document.createElement("input");
    newInput.setAttribute('name', myElement.name);
    newInput.setAttribute('value', myElement.value);
    newInput.setAttribute('type', 'hidden');
    myForm.appendChild(newInput);  
}
function collapseLinkBlock()
{
    var linkCheckBox = document.getElementById('page[has_link]');
    var myLinkBlock = document.getElementById('linkBlock');
    if (linkCheckBox.checked){
        myLinkBlock.style.display = 'block';
    } else {
        myLinkBlock.style.display = 'none';
    }
}
</script>

<span flexy:if="msgGet()">{msgGet()}</span>

<form method="post" name="sectionEdit" flexy:ignore id="sectionEdit">
    <input type="hidden" name="action" value="{action}" />

    <input type="hidden" name="page[section_id]" value="{section[section_id]}" />
    <input type="hidden" name="page[order_id]" value="{section[order_id]}" />
    <input type="hidden" name="page[original_parent_id]" value="{section[parent_id]}" />
    <input type="hidden" name="page[original_is_enabled]" value="{section[is_enabled]}" />
    <input type="hidden" name="page[original_has_link]" value="{section[has_link]}" />

    <fieldset style="width:95%">
        <legend>{if:section[section_id]}{translate(#Section ID#)} : {section[section_id]}
        {else:} {translate(#New section#)}{end:}</legend>
        <p class="error">{foreach:error,error,string} <strong>{translate(string)}</strong><br />
            {end:}</p>
        
        <div class="row">
        <label for="page[title]">{translate(#Page title#)}:</label>
        <input type="text" name="page[title]" id="page[title]" value="{section[title]:h}" />
        </div>
        <div class="row">
        <label for="page[parent_id]">{translate(#Parent page#)}:</label>
        <select name="page[parent_id]" id="page[parent_id]">
            {sectionNodesOptions:h}
        </select>
        </div>
        <div class="row">
        <label for="page[has_link]">{translate(#Link this item#)}:</label>
        <input type="checkbox" name="page[has_link]" id="page[has_link]" flexy:raw="{pageHasLink}" onClick="collapseLinkBlock();"/> {translate(#check to make a link#)}
        </div>
        <fieldset id="linkBlock" style="margin-left:30px;">
            <legend>{translate(#Link information#)}</legend>
            <div class="row">
            <label for="page[module]">{translate(#Module#)}:</label>
            <select size="1" name="page[module]" id="page[module]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aModules,section[module]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[manager]">{translate(#Manager#)}:</label>
            <select size="1" name="page[manager]" id="page[manager]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aManagers,section[manager]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[actionMapping]">{translate(#Action#)}:</label>
            <select size="1" name="page[actionMapping]" id="page[actionMapping]">
                <option value="">{translate(#None#)}
                {generateSelect(aActions,section[actionMapping]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[add_params]">{translate(#Additional params#)}:</label>
            <input type="text" name="page[add_params]" id="page[add_params]" value="{section[add_params]}" /> {translate(#separate with slashes (/)#)}
            </div>
            <div class="row">
            <label for="page[anchor]">{translate(#Anchor#)}:</label>
            <input type="text" name="page[anchor]" id="page[anchor]" value="{section[anchor]}" /> {translate(#just the anchor name#)}
            </div>
        </fieldset>
        <div class="row">
        <label for="page[is_enabled]">{translate(#Status#)}:</label>
        <input type="checkbox" name="page[is_enabled]" id="page[is_enabled]" flexy:raw="{pageIsEnabled}" /> {translate(#check to activate#)}
        </div>
        <div class="row">
        <label for="page[perms][]">{translate(#Has permissions#)}:</label>
        <select size="5" name="page[perms][]" id="page[perms][]" multiple="multiple">
            {generateSelect(aRoles,aSelectedRoles,1):h}
        </select>
        </div>
    </fieldset>
    <div class="submissionPanel">
        <input class="wideButton" type="submit" name="submitted" value="{translate(#Save#)}" />
        <input class="wideButton" type="button" name="cancel" value="{translate(#Cancel#)}" onclick="document.location.href='{makeUrl(#list#,#adminmenu#,#admin#)}'" />
    </div>
    
</form>
<script type="text/javascript">
function addFormValue(myElement, form)
{
    var myForm = document.getElementById(form);
    
    newInput = document.createElement("input");
    newInput.setAttribute('name', myElement.name);
    newInput.setAttribute('value', myElement.value);
    newInput.setAttribute('type', 'hidden');
    myForm.appendChild(newInput);  
}
function collapseLinkBlock()
{
    var linkCheckBox = document.getElementById('page[has_link]');
    var myLinkBlock = document.getElementById('linkBlock');
    if (linkCheckBox.checked){
        myLinkBlock.style.display = 'block';
    } else {
        myLinkBlock.style.display = 'none';
    }
}
</script>

<span flexy:if="msgGet()">{msgGet()}</span>

<form method="post" name="sectionEdit" flexy:ignore id="sectionEdit">
    <input type="hidden" name="action" value="{action}" />

    <input type="hidden" name="page[section_id]" value="{section[section_id]}" />
    <input type="hidden" name="page[order_id]" value="{section[order_id]}" />
    <input type="hidden" name="page[original_parent_id]" value="{section[parent_id]}" />
    <input type="hidden" name="page[original_is_enabled]" value="{section[is_enabled]}" />
    <input type="hidden" name="page[original_has_link]" value="{section[has_link]}" />

    <fieldset style="width:95%">
        <legend>{if:section[section_id]}{translate(#Section ID#)} : {section[section_id]}
        {else:} {translate(#New section#)}{end:}</legend>
        <p class="error">{foreach:error,error,string} <strong>{translate(string)}</strong><br />
            {end:}</p>
        
        <div class="row">
        <label for="page[title]">{translate(#Page title#)}:</label>
        <input type="text" name="page[title]" id="page[title]" value="{section[title]:h}" />
        </div>
        <div class="row">
        <label for="page[parent_id]">{translate(#Parent page#)}:</label>
        <select name="page[parent_id]" id="page[parent_id]">
            {sectionNodesOptions:h}
        </select>
        </div>
        <div class="row">
        <label for="page[has_link]">{translate(#Link this item#)}:</label>
        <input type="checkbox" name="page[has_link]" id="page[has_link]" flexy:raw="{pageHasLink}" onClick="collapseLinkBlock();"/> {translate(#check to make a link#)}
        </div>
        <fieldset id="linkBlock" style="margin-left:30px;">
            <legend>{translate(#Link information#)}</legend>
            <div class="row">
            <label for="page[module]">{translate(#Module#)}:</label>
            <select size="1" name="page[module]" id="page[module]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aModules,section[module]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[manager]">{translate(#Manager#)}:</label>
            <select size="1" name="page[manager]" id="page[manager]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aManagers,section[manager]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[actionMapping]">{translate(#Action#)}:</label>
            <select size="1" name="page[actionMapping]" id="page[actionMapping]">
                <option value="">{translate(#None#)}
                {generateSelect(aActions,section[actionMapping]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[add_params]">{translate(#Additional params#)}:</label>
            <input type="text" name="page[add_params]" id="page[add_params]" value="{section[add_params]}" /> {translate(#separate with slashes (/)#)}
            </div>
            <div class="row">
            <label for="page[anchor]">{translate(#Anchor#)}:</label>
            <input type="text" name="page[anchor]" id="page[anchor]" value="{section[anchor]}" /> {translate(#just the anchor name#)}
            </div>
        </fieldset>
        <div class="row">
        <label for="page[is_enabled]">{translate(#Status#)}:</label>
        <input type="checkbox" name="page[is_enabled]" id="page[is_enabled]" flexy:raw="{pageIsEnabled}" /> {translate(#check to activate#)}
        </div>
        <div class="row">
        <label for="page[perms][]">{translate(#Has permissions#)}:</label>
        <select size="5" name="page[perms][]" id="page[perms][]" multiple="multiple">
            {generateSelect(aRoles,aSelectedRoles,1):h}
        </select>
        </div>
    </fieldset>
    <div class="submissionPanel">
        <input class="wideButton" type="submit" name="submitted" value="{translate(#Save#)}" />
        <input class="wideButton" type="button" name="cancel" value="{translate(#Cancel#)}" onclick="document.location.href='{makeUrl(#list#,#adminmenu#,#admin#)}'" />
    </div>
    
</form>
<script type="text/javascript">
function addFormValue(myElement, form)
{
    var myForm = document.getElementById(form);
    
    newInput = document.createElement("input");
    newInput.setAttribute('name', myElement.name);
    newInput.setAttribute('value', myElement.value);
    newInput.setAttribute('type', 'hidden');
    myForm.appendChild(newInput);  
}
function collapseLinkBlock()
{
    var linkCheckBox = document.getElementById('page[has_link]');
    var myLinkBlock = document.getElementById('linkBlock');
    if (linkCheckBox.checked){
        myLinkBlock.style.display = 'block';
    } else {
        myLinkBlock.style.display = 'none';
    }
}
</script>

<span flexy:if="msgGet()">{msgGet()}</span>

<form method="post" name="sectionEdit" flexy:ignore id="sectionEdit">
    <input type="hidden" name="action" value="{action}" />

    <input type="hidden" name="page[section_id]" value="{section[section_id]}" />
    <input type="hidden" name="page[order_id]" value="{section[order_id]}" />
    <input type="hidden" name="page[original_parent_id]" value="{section[parent_id]}" />
    <input type="hidden" name="page[original_is_enabled]" value="{section[is_enabled]}" />
    <input type="hidden" name="page[original_has_link]" value="{section[has_link]}" />

    <fieldset style="width:95%">
        <legend>{if:section[section_id]}{translate(#Section ID#)} : {section[section_id]}
        {else:} {translate(#New section#)}{end:}</legend>
        <p class="error">{foreach:error,error,string} <strong>{translate(string)}</strong><br />
            {end:}</p>
        
        <div class="row">
        <label for="page[title]">{translate(#Page title#)}:</label>
        <input type="text" name="page[title]" id="page[title]" value="{section[title]:h}" />
        </div>
        <div class="row">
        <label for="page[parent_id]">{translate(#Parent page#)}:</label>
        <select name="page[parent_id]" id="page[parent_id]">
            {sectionNodesOptions:h}
        </select>
        </div>
        <div class="row">
        <label for="page[has_link]">{translate(#Link this item#)}:</label>
        <input type="checkbox" name="page[has_link]" id="page[has_link]" flexy:raw="{pageHasLink}" onClick="collapseLinkBlock();"/> {translate(#check to make a link#)}
        </div>
        <fieldset id="linkBlock" style="margin-left:30px;">
            <legend>{translate(#Link information#)}</legend>
            <div class="row">
            <label for="page[module]">{translate(#Module#)}:</label>
            <select size="1" name="page[module]" id="page[module]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aModules,section[module]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[manager]">{translate(#Manager#)}:</label>
            <select size="1" name="page[manager]" id="page[manager]"
                onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                {generateSelect(aManagers,section[manager]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[actionMapping]">{translate(#Action#)}:</label>
            <select size="1" name="page[actionMapping]" id="page[actionMapping]">
                <option value="">{translate(#None#)}
                {generateSelect(aActions,section[actionMapping]):h}
            </select>
            </div>
            <div class="row">
            <label for="page[add_params]">{translate(#Additional params#)}:</label>
            <input type="text" name="page[add_params]" id="page[add_params]" value="{section[add_params]}" /> {translate(#separate with slashes (/)#)}
            </div>
            <div class="row">
            <label for="page[anchor]">{translate(#Anchor#)}:</label>
            <input type="text" name="page[anchor]" id="page[anchor]" value="{section[anchor]}" /> {translate(#just the anchor name#)}
            </div>
        </fieldset>
        <div class="row">
        <label for="page[is_enabled]">{translate(#Status#)}:</label>
        <input type="checkbox" name="page[is_enabled]" id="page[is_enabled]" flexy:raw="{pageIsEnabled}" /> {translate(#check to activate#)}
        </div>
        <div class="row">
        <label for="page[perms][]">{translate(#Has permissions#)}:</label>
        <select size="5" name="page[perms][]" id="page[perms][]" multiple="multiple">
            {generateSelect(aRoles,aSelectedRoles,1):h}
        </select>
        </div>
    </fieldset>
    <div class="submissionPanel">
        <input class="wideButton" type="submit" name="submitted" value="{translate(#Save#)}" />
        <input class="wideButton" type="button" name="cancel" value="{translate(#Cancel#)}" onclick="document.location.href='{makeUrl(#list#,#adminmenu#,#admin#)}'" />
    </div>
    
</form>
