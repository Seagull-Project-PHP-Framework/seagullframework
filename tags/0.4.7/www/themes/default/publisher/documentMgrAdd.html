<div id="alertNotFinished" class="hide">{translate(#Please wait until upload is finished#)}</div>
<div id="alertNoFile" class="hide">{translate(#You must select a file to upload#)}</div>
<div id="alertPleaseWait" class="hide">{translate(#Please wait while document uploads#)}</div>
<script type='text/javascript'>
//<![CDATA[
<!--
    /* alert messages: */
    var alertNotFinished    = document.getElementById('alertNotFinished').innerHTML;
    var alertNoFile         = document.getElementById('alertNoFile').innerHTML;
    var alertPleaseWait     = document.getElementById('alertPleaseWait').innerHTML;

    function doAttach()
    {
        if (document.uploadAsset.assetFile.value==""){
            alert(alertNoFile);
        return false;
        } else {//Launch uploading document message
            avoidDown();
            msgUp();
        }
    }

    var cteTxti = '<table class="wide">'
                + '<tr><td align="left" width="250" nowrap><span class="error">'
                + alertPleaseWait;
    var cteTxtf = '<\/span><\/td><\/tr><\/table>';
    var msgPts  = '';

    function msgUp()
    {
            msgPts = (msgPts.length > 7) ? '.' : msgPts + '.';
            uploadLayer = document.getElementById('uploadLayer');

            uploadLayer.innerHTML = cteTxti + msgPts + cteTxtf;
            idetifier = setTimeout('msgUp()',100);
    }

    function avoidDown()
    {
        document.onmousedown = document.onkeydown = function () {alert(alertNotFinished);}
    }

//-->
//]]>
</script>

<form method="post" name="uploadAsset" enctype="multipart/form-data" action="" flexy:ignore id="uploadAsset">
    {if:save}
        <input type="hidden" name="action" value="insert" />
    {else:}
        <input type="hidden" name="action" value="add" />
    {end:}
    <input type="hidden" name="frmDocumentCatID" value="{docCatID}" />
    <input type="hidden" name="document[document_type_id]" value="{assetTypeID}" />
    <input type="hidden" name="document[added_by]" value="{loggedOnUserID}" />
    <input type="hidden" name="document[orig_name]" value="{assetFileName}" />
    <input type="hidden" name="document[mime_type]" value="{assetFileType}" />
    <input type="hidden" name="document[file_size]" value="{assetFileSize}" />
    <span flexy:if="msgGet()">{msgGet()}</span>

    <table class="wide">
        <tr>
            <td colspan="2">
                <h3>{translate(#New Asset#)}</h3>
            </td>
        </tr>
    </table>

    <table class="wide">
        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Owner#)}</th>
            <td width="70%">{loggedOnUser}</td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Category#)}</th>
            <td width="70%">{breadCrumbs:h}</td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Change Category#)}</th>
            <td width="70%">
                <select name="frmCategoryChangeToID">{generateSelect(aCategories,currentCat):h}</select></td>
        </tr>

        {if:save}
        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Type#)}</th>
            <td width="70%">{assetTypeName}</td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Asset Name#)}</th>
            <td width="70%"><input type="text" name="document[name]" value="{assetFileName}" size="40" /></td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Description#)}</th>
            <td width="70%">
            <textarea cols="40" rows="5" name="document[description]"></textarea></td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Size#)}</th>
            <td width="70%">{formatBytes(assetFileSize)} Kb</td>
        </tr>

        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Mime Type#)}</th>
            <td width="70%">{assetFileType}</td>
        </tr>

        <tr>
            <td width="100%" colspan="2" align="center" nowrap="nowrap"><input class="wideButton" type="submit" name="submit" value="{translate(#Save#)}" /> <input class="wideButton" type="button" value="{translate(#Cancel#)}" onclick="javascript:document.location.href='{makeUrl(##,#document#,#publisher#)}'" /></td>
        </tr>
        {else:}
        <tr>
            <th width="30%" nowrap="nowrap">{translate(#Locate#)}</th>
            <td width="70%"> <input type="file" name="assetFile" /></td>
        </tr>

        <tr>
            <td colspan="2">&nbsp;</td>
        </tr>

        <tr>
            <td width="100%" colspan="2" align="center" nowrap="nowrap">
                <input class="wideButton" type="submit" name="submit" value="{translate(#Upload#)}" onclick="return doAttach();" />
                <input class="wideButton" type="button" value="{translate(#Cancel#)}"
                    onclick="javascript:document.location.href='{makeUrl(##,#document#,#publisher#)}'" />
                <div id="uploadLayer" style="position:relative; left:10px; top:0px"></div>
            </td>
        </tr>
        {end:}
    </table>
</form>
