<flexy:include src="resourceChooser.html" /> 
<link rel="stylesheet" type="text/css" href="{webRoot}/themes/{theme}/css/shop.css" />
<h1 class="pageTitle">{translate(pageTitle)}</h1>
<p><span flexy:if="msgGet()">{msgGet()}</span> </p>

<a href="{makeUrl(#csvExport#)}">{translate(#Export all products to CSV#)}<br /><br />

{if:csvUploadResult} 
<!--<pre>{result}</pre>-->
<script language="JavaScript">
function selectAll(mode, i) {
    if (i == 1) {
        obj = document.forms['produse'].elements;
    } else {
        obj = document.forms['produse'].elements;
    };
    
    for (i = 0; i < obj.length; i++)
        if (obj[i].name == 'frmDelete[]') obj[i].checked = mode;
    
}

function selchkAll(chk, i) {
    if (chk.checked) {
        selectAll(true, i);
    }
    else {
        selectAll(false, i);
    }
}
</script>
<form name="produse" method="post" flexy:ignore id="produse">
  <input type="hidden" name="action" value="csvDelete" />
  <table class="wide">
    <tr> 
      <td colspan="8">
	  <input type="button" value="{translate(#CSV file upload#)}" onclick="javascript:document.location.href='{makeUrl(#csvUpload#)}'" /> 
	  <input type="button" value="{translate(#Process CSV file#)}" onclick="javascript:document.location.href='{makeUrl(#csvProcess#)}'" />
      </td>
    </tr>
    <tr>
      <th width="5"><div align="center"><input type="checkbox" name="selAll" value="checkbox" onclick="selchkAll(this, 1);"></div></th>
      <th width="10">{translate(#ID#)}</th>
      <th width="50">{translate(#Action#)}</th>
      <th width="50" nowarp>{translate(#Cod1#)}</th>
      <th width="50" nowarp>{translate(#Cod2#)}</th>
      <th width="30" nowarp>{translate(#CatID#)}</th>
      <th width="40%">{translate(#Product#)}</th>
      <th width="10">{translate(#Edit#)}</th>
    </tr>
	{foreach:csvRows,key,rowObj}
    <tr flexy:if=rowObj.error>
      <td colspan="8"><div class="error">{rowObj.error}</div></td>
    </tr>
    <tr flexy:if=rowObj.notice>
      <td colspan="8"><div class="notice">{rowObj.notice}</div></td>
    </tr>
    <tr class="{switchRowClass()}">
      <td width="5" align="center"> <input class="noBorder" type="checkbox" name="frmDelete[]" value="{key}" /></td>
      <td width="5">{key}</td>
      <td width="50" nowarp>{rowObj.action}</td>
      <td width="30" nowarp>{rowObj.cod1}</td>
      <td width="30" nowarp>{rowObj.cod2}</td>
      <td width="30" nowarp>{rowObj.cat_id}</td>
      <td width="40%">{rowObj.name}</td>
      <td width="10" align="center"><a href="{makeUrl(#csvEdit#)}frmProdId/{key}/"><img src="{webRoot}/themes/{theme}/images/edit.gif" border="0" /></a></td>
    </tr>
	{end:}
    <tr> 
      <td colspan="8">{translate(#With selected product(s)#)}: 
        <input type="SUBMIT" name="delete" value="{translate(#delete#)}" onclick="return confirmSubmit('produs', 'produse')" />
      </td>
    </tr>
  </table>
</form>
{else:} 
<form method="post" action="" name="produse" enctype="multipart/form-data"  flexy:ignore>
  <input type="hidden" name="action" value="csvUpload" />
  <input type="hidden" name="csvType" value="products" />
  <input type="hidden" name="frmCatID" value="{catID}" /> <!--  ??? -->
  <table class="productText" border="0">
    <tr> 
      <td width="150" nowrap class="productDescKey">{translate(#CSV file upload#)}:</td>
      <td>
         <div class="error" flexy:if="error[csvUpload]">{error[csvUpload]} </div>
         <input type="file" name="csvFile" size="28" />
	 <input type="submit" name="submitted" value="{translate(#Upload#)}" />
      </td>
    </tr>
  </table>
</form>
{end:} 
