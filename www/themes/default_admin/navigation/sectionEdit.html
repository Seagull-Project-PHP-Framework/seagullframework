<script type="text/javascript">
function addFormValue(myElement, form)
{
    var myForm = document.getElementById(form);

    newInput = document.createElement("input");
    newInput.setAttribute('name', myElement.name);
    newInput.setAttribute('value', myElement.value);
    newInput.setAttribute('type', 'hidden');
    myForm.appendChild(newInput);
}

function collapseElement(display,elementId)
{
    var blockToCollapse = document.getElementById(elementId);
    if (display){
        blockToCollapse.style.display = 'block';
    } else {
        blockToCollapse.style.display = 'none';
    }
}

function toggleAliasElements(myCheckbox)
{
        var myCheckbox = document.getElementById('page[uri_alias_enable]').checked;
        var aliasList = document.getElementById('urialiases');
        var aliasValue = document.getElementById('page[uri_alias]');

        if (myCheckbox) {
            //aliasList.disabled = false;
            aliasValue.disabled = false;
        } else {
            //aliasList.disabled = true;
            aliasValue.disabled = true;
        }


}
</script>

<form method="post" name="sectionEdit" flexy:ignore id="sectionEdit" action="">
    <span flexy:if="msgGet()">{msgGet()}</span>
    
    <div class="formOptions" id="navigationOptions">
        <fieldset>
            <legend>Emplacement</legend>
            <p>
                <label>{translate(#Parent Page#)}</label>
                <select name="page[parent_id]">
                    {sectionNodesOptions:h}
                </select>
            </p>
        </fieldset>
        <fieldset>
            <legend>Paramètres</legend>
            <p>
                <label class="tipOwner" for="page[anchor]">{translate(#Anchor#)}
                <span class="tipText">{translate(#just the anchor name#)}</span>
                </label>
                <input type="text" name="page[anchor]" id="page[anchor]" value="{section[anchor]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[access_key]">{translate(#Access Key#)}
                <span class="tipText">{translate(#Any number, which can be pressed with the ALT-key to load the page.#)}</span>
                </label>
                <input type="text" name="page[access_key]" id="page[access_key]" value="{section[access_key]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[rel]">{translate(#Rel Marker#)}
                <span class="tipText">{translate(#Additional navigation aids for better accessibility. Use values like "home", "prev" or "next".#)}</span>
                </label>
                <input type="text" name="page[rel]" id="page[rel]" value="{section[rel]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[add_params]">{translate(#Additional params#)}
                <span class="tipText">{translate(#separate with slashes (/)#)}</span>
                </label>
                <input type="text" class="longText" name="page[add_params]" id="page[add_params]" value="{section[add_params]}" />
            </p>
        </fieldset>
        <fieldset>
            <legend>Options de publication</legend>
            <p>
                <label class="tipOwner" for="page[is_enabled]">{translate(#publish#,#ucfirst#)}
                <span class="tipText">{translate(#check to activate#)}</span>
                </label>
                {generateRadioPair(#page[is_enabled]#,pageIsEnabled):h}
            </p>
            <p>
                <label class="tipOwner" for="page[perms][]">{translate(#Can view#)}
                <span class="tipText">{translate(#Select roles to which you want to grant access#)}</span>
                </label>
                <select size="5" name="page[perms][]" id="page[perms][]" multiple="multiple">
                    {generateSelect(aRoles,aSelectedRoles,1):h}
                </select>
            </p><div class="spacer"></div>
        </fieldset>

    </div>
    <div class="formContent" id="navigationContent">
        <fieldset>
            <input type="hidden" name="action" value="{action}" />
            <input type="hidden" name="page[section_id]" value="{section[section_id]}" />
            <input type="hidden" name="page[order_id]" value="{section[order_id]}" />
            <input type="hidden" name="page[original_parent_id]" value="{section[parent_id]}" />
            <input type="hidden" name="page[original_is_enabled]" value="{section[is_enabled]}" />
            <input type="hidden" name="page[trans_id]" value="{section[trans_id]}" />
            {foreach:availableLangs,langID,langName}
            <input type="hidden" name="frmAvailableLangs[{langID}]" value="{langID}" />
            {end:}
            
            <h3>
                {if:section[section_id]}
                {translate(#page#,#ucfirst#)} (id#{section[section_id]}) : {section[title]}
                {else:}
                {translate(#New page#)}{end:}
            </h3>
            <p class="errorMsg">{foreach:error,error,string}
            {string}. 
            {end:}
            </p>
            
            <p>
                <label for="frmNavLang">{translate(#Language#)}</label>
                {if:actionIsAdd}
                <select name="frmNavLang" id="frmNavLang">
                    <option value="{navLang}">{fullNavLang}</option>
                </select>
                {else:}
                <select name="frmNavLang" id="frmNavLang" 
                        onchange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                    {generateSelect(availableLangs,navLang):h}
                </select>
                {end:}
            </p>
            <p>
                <label for="page[title]">{translate(#Page Title#)} - {fullNavLang}</label>
                <input type="text" class="longText" name="page[title]" id="page[title]" value="{section[title]:h}" />
                <input type="hidden" name="page[title_original]" value="{section[title]:h}" />
            </p>
            <p>
                <label class="tipOwner" for="page[has_link]">{translate(#has a link#,#ucfirst#)}
                <span class="tipText">{translate(#Currently not available !<br />If you leave this box unchecked, you will create a menu item without a link.#):h}</span>
                </label>
                <input type="checkbox" name="page[has_link]" id="page[has_link]" flexy:raw="{pageHasLink:h}" onClick="collapseElement(this.checked,'linkInformation');"/>
            </p>
            <fieldset id="linkInformation">
                <legend>link information</legend>
                <p>
                    <label for="page[articleType]">{translate(#target#,#ucfirst#)}</label>
                    <select name="page[articleType]" id="page[articleType]" onchange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()" class="articleType">
                        <option value="static" flexy:raw="{staticSelected}">
                            {translate(#static articles#)}
                        </option>
                        <option value="dynamic" flexy:raw="{dynamicSelected}">
                            {translate(#dynamic pages#)}
                        </option>
                        {if:conf[PageMgr][wikiScreenTypeEnabled]}
                        <option value="wiki" flexy:raw="{wikiSelected}">
                            wiki
                        </option>
                        {end:}
                        <option value="uriExternal" flexy:raw="{uriExternalSelected}">
                            {translate(#external URI#)}
                        </option>
                    </select>
                </p>
                {if:staticSelected}
                <p>
                    <label for="page[staticArticleId]">{translate(#static article title#,#ucfirst#)}</label>
                    <select size="1" name="page[staticArticleId]" id="page[staticArticleId]">
                        {generateSelect(aStaticArticles,section[resource_uri],currentLang):h}
                    </select>
                </p>
                {end:}
                {if:dynamicSelected}
                <p>
                    <label for="page[module]">{translate(#Module#)}</label>
                    <select size="1" name="page[module]" id="page[module]"
                        onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                        {generateSelect(aModules,section[module]):h}
                    </select>
                </p>
                <p>
                    <label for="page[manager]">{translate(#Manager#)}</label>
                    <select size="1" name="page[manager]" id="page[manager]"
                        onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                        {generateSelect(aManagers,section[manager]):h}
                    </select>
                </p>
                <p>
                    <label for="page[actionMapping]">{translate(#action#,#ucfirst#)}</label>
                    <select size="1" name="page[actionMapping]" id="page[actionMapping]">
                        <option value="">none
                        {generateSelect(aActions,section[actionMapping]):h}
                    </select>
                </p>
                {end:}
                {if:wikiSelected}
                <p>
                    <label for="page[resource_uri]">{translate(#Wiki page Url#)}</label>
                    <input type="text" size="50" name="page[resource_uri]" id="page[resource_uri]" value="{section[resource_uri]}">
                </p>
                {end:}
                {if:uriExternalSelected}
                <p>
                    <label for="page[resource_uri]">{translate(#External page URI#)}</label>
                    <input type="text" class="longText" name="page[resource_uri]" id="page[resource_uri]" value="{section[resource_uri]}">
                </p>
                {end:}
                <p>
                    <label for="page[uri_alias_enable]">{translate(#add an alias?#,#ucfirst#)}</label>
                    <input type="checkbox" name="page[uri_alias_enable]" id="page[uri_alias_enable]" onClick="toggleAliasElements();">
                </p>
                <p>
                    <label for="page[uri_alias]">{translate(#alias URI#,#ucfirst#)}</label>
                    <input type="text" class="longText" name="page[uri_alias]" id="page[uri_alias]" value="{section[uri_alias]}">
                </p>
            </fieldset>
        </fieldset>
    <div class="spacer"></div>
    </div>
    
</form>
<script type="text/javascript">
function addFormValue(myElement, form)
{
    var myForm = document.getElementById(form);

    newInput = document.createElement("input");
    newInput.setAttribute('name', myElement.name);
    newInput.setAttribute('value', myElement.value);
    newInput.setAttribute('type', 'hidden');
    myForm.appendChild(newInput);
}

function collapseElement(display,elementId)
{
    var blockToCollapse = document.getElementById(elementId);
    if (display){
        blockToCollapse.style.display = 'block';
    } else {
        blockToCollapse.style.display = 'none';
    }
}

function toggleAliasElements(myCheckbox)
{
        var myCheckbox = document.getElementById('page[uri_alias_enable]').checked;
        var aliasList = document.getElementById('urialiases');
        var aliasValue = document.getElementById('page[uri_alias]');

        if (myCheckbox) {
            //aliasList.disabled = false;
            aliasValue.disabled = false;
        } else {
            //aliasList.disabled = true;
            aliasValue.disabled = true;
        }


}
</script>

<form method="post" name="sectionEdit" flexy:ignore id="sectionEdit" action="">
    <span flexy:if="msgGet()">{msgGet()}</span>
    
    <div class="formOptions" id="navigationOptions">
        <fieldset>
            <legend>Emplacement</legend>
            <p>
                <label>{translate(#Parent Page#)}</label>
                <select name="page[parent_id]">
                    {sectionNodesOptions:h}
                </select>
            </p>
        </fieldset>
        <fieldset>
            <legend>Paramètres</legend>
            <p>
                <label class="tipOwner" for="page[anchor]">{translate(#Anchor#)}
                <span class="tipText">{translate(#just the anchor name#)}</span>
                </label>
                <input type="text" name="page[anchor]" id="page[anchor]" value="{section[anchor]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[access_key]">{translate(#Access Key#)}
                <span class="tipText">{translate(#Any number, which can be pressed with the ALT-key to load the page.#)}</span>
                </label>
                <input type="text" name="page[access_key]" id="page[access_key]" value="{section[access_key]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[rel]">{translate(#Rel Marker#)}
                <span class="tipText">{translate(#Additional navigation aids for better accessibility. Use values like "home", "prev" or "next".#)}</span>
                </label>
                <input type="text" name="page[rel]" id="page[rel]" value="{section[rel]}" />
            </p>
            <p>
                <label class="tipOwner" for="page[add_params]">{translate(#Additional params#)}
                <span class="tipText">{translate(#separate with slashes (/)#)}</span>
                </label>
                <input type="text" class="longText" name="page[add_params]" id="page[add_params]" value="{section[add_params]}" />
            </p>
        </fieldset>
        <fieldset>
            <legend>Options de publication</legend>
            <p>
                <label class="tipOwner" for="page[is_enabled]">{translate(#publish#,#ucfirst#)}
                <span class="tipText">{translate(#check to activate#)}</span>
                </label>
                {generateRadioPair(#page[is_enabled]#,pageIsEnabled):h}
            </p>
            <p>
                <label class="tipOwner" for="page[perms][]">{translate(#Can view#)}
                <span class="tipText">{translate(#Select roles to which you want to grant access#)}</span>
                </label>
                <select size="5" name="page[perms][]" id="page[perms][]" multiple="multiple">
                    {generateSelect(aRoles,aSelectedRoles,1):h}
                </select>
            </p><div class="spacer"></div>
        </fieldset>

    </div>
    <div class="formContent" id="navigationContent">
        <fieldset>
            <input type="hidden" name="action" value="{action}" />
            <input type="hidden" name="page[section_id]" value="{section[section_id]}" />
            <input type="hidden" name="page[order_id]" value="{section[order_id]}" />
            <input type="hidden" name="page[original_parent_id]" value="{section[parent_id]}" />
            <input type="hidden" name="page[original_is_enabled]" value="{section[is_enabled]}" />
            <input type="hidden" name="page[trans_id]" value="{section[trans_id]}" />
            {foreach:availableLangs,langID,langName}
            <input type="hidden" name="frmAvailableLangs[{langID}]" value="{langID}" />
            {end:}
            
            <h3>
                {if:section[section_id]}
                {translate(#page#,#ucfirst#)} (id#{section[section_id]}) : {section[title]}
                {else:}
                {translate(#New page#)}{end:}
            </h3>
            <p class="errorMsg">{foreach:error,error,string}
            {string}. 
            {end:}
            </p>
            
            <p>
                <label for="frmNavLang">{translate(#Language#)}</label>
                {if:actionIsAdd}
                <select name="frmNavLang" id="frmNavLang">
                    <option value="{navLang}">{fullNavLang}</option>
                </select>
                {else:}
                <select name="frmNavLang" id="frmNavLang" 
                        onchange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                    {generateSelect(availableLangs,navLang):h}
                </select>
                {end:}
            </p>
            <p>
                <label for="page[title]">{translate(#Page Title#)} - {fullNavLang}</label>
                <input type="text" class="longText" name="page[title]" id="page[title]" value="{section[title]:h}" />
                <input type="hidden" name="page[title_original]" value="{section[title]:h}" />
            </p>
            <p>
                <label class="tipOwner" for="page[has_link]">{translate(#has a link#,#ucfirst#)}
                <span class="tipText">{translate(#Currently not available !<br />If you leave this box unchecked, you will create a menu item without a link.#):h}</span>
                </label>
                <input type="checkbox" name="page[has_link]" id="page[has_link]" flexy:raw="{pageHasLink:h}" onClick="collapseElement(this.checked,'linkInformation');"/>
            </p>
            <fieldset id="linkInformation">
                <legend>link information</legend>
                <p>
                    <label for="page[articleType]">{translate(#target#,#ucfirst#)}</label>
                    <select name="page[articleType]" id="page[articleType]" onchange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()" class="articleType">
                        <option value="static" flexy:raw="{staticSelected}">
                            {translate(#static articles#)}
                        </option>
                        <option value="dynamic" flexy:raw="{dynamicSelected}">
                            {translate(#dynamic pages#)}
                        </option>
                        {if:conf[PageMgr][wikiScreenTypeEnabled]}
                        <option value="wiki" flexy:raw="{wikiSelected}">
                            wiki
                        </option>
                        {end:}
                        <option value="uriExternal" flexy:raw="{uriExternalSelected}">
                            {translate(#external URI#)}
                        </option>
                    </select>
                </p>
                {if:staticSelected}
                <p>
                    <label for="page[staticArticleId]">{translate(#static article title#,#ucfirst#)}</label>
                    <select size="1" name="page[staticArticleId]" id="page[staticArticleId]">
                        {generateSelect(aStaticArticles,section[resource_uri],currentLang):h}
                    </select>
                </p>
                {end:}
                {if:dynamicSelected}
                <p>
                    <label for="page[module]">{translate(#Module#)}</label>
                    <select size="1" name="page[module]" id="page[module]"
                        onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                        {generateSelect(aModules,section[module]):h}
                    </select>
                </p>
                <p>
                    <label for="page[manager]">{translate(#Manager#)}</label>
                    <select size="1" name="page[manager]" id="page[manager]"
                        onChange="addFormValue(this, 'sectionEdit'); self.document.sectionEdit.submit()">
                        {generateSelect(aManagers,section[manager]):h}
                    </select>
                </p>
                <p>
                    <label for="page[actionMapping]">{translate(#action#,#ucfirst#)}</label>
                    <select size="1" name="page[actionMapping]" id="page[actionMapping]">
                        <option value="">none
                        {generateSelect(aActions,section[actionMapping]):h}
                    </select>
                </p>
                {end:}
                {if:wikiSelected}
                <p>
                    <label for="page[resource_uri]">{translate(#Wiki page Url#)}</label>
                    <input type="text" size="50" name="page[resource_uri]" id="page[resource_uri]" value="{section[resource_uri]}">
                </p>
                {end:}
                {if:uriExternalSelected}
                <p>
                    <label for="page[resource_uri]">{translate(#External page URI#)}</label>
                    <input type="text" class="longText" name="page[resource_uri]" id="page[resource_uri]" value="{section[resource_uri]}">
                </p>
                {end:}
                <p>
                    <label for="page[uri_alias_enable]">{translate(#add an alias?#,#ucfirst#)}</label>
                    <input type="checkbox" name="page[uri_alias_enable]" id="page[uri_alias_enable]" onClick="toggleAliasElements();">
                </p>
                <p>
                    <label for="page[uri_alias]">{translate(#alias URI#,#ucfirst#)}</label>
                    <input type="text" class="longText" name="page[uri_alias]" id="page[uri_alias]" value="{section[uri_alias]}">
                </p>
            </fieldset>
        </fieldset>
    <div class="spacer"></div>
    </div>
    
</form>
