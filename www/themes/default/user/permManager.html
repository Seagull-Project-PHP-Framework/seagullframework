{if:liveUserEnabled}
    <flexy:include src="userModuleSubNavLiveuser.html" />
{else:}
    <flexy:include src="userModuleSubNavSgl.html" />
{end:}

<h1 class="pageTitle">{translate(pageTitle)}</h1>
<span flexy:if="msgGet()">{msgGet()}</span>

{if:pager}<flexy:include src="pager.html" />{end:}
<form name="frmFilterSwitcher" method="get" flexy:ignore>
<table class="wide">
    <tr>
        <td colspan="5">
        <input type="button" value="{translate(#add permission#)}" 
            onClick="javascript:document.location.href='{makeUrl(#add#,#permission#,#user#,##,#frmPermId|moduleId#)}'" />
        <input type="button" value="{translate(#detect & add permissions#)}" 
            onClick="javascript:document.location.href='{makeUrl(#scanNew#,#permission#,#user#,##,#frmPermId|moduleId#)}'" />
        <input type="button" value="{translate(#remove orphaned#)}" 
            onClick="javascript:document.location.href='{makeUrl(#scanOrphaned#,#permission#,#user#,##,#frmPermId|moduleId#)}'" />
        &nbsp;{translate(#filter by module#)} 
        <select name="frmModuleId"
                onChange="javascript:document.location.href='{makeUrl(#list#,#permission#,#user#)}frmModuleId/' + getSelectedValue(self.document.frmFilterSwitcher.frmModuleId) + '/';" />    
            <option value="" />
            {translate(#all#)}                       
            {generateSelect(aModules,currentModule):h}
        </select>
        </td>
    </tr>
</table>
</form>

<form name="perms" method="post" flexy:ignore>
<input type="hidden" name="action" value="delete" />
<table class="wide">
    <tr>
        <th>{translate(#Select#)}</th>
        <th>{translate(#Perm ID#)}</th>
        <th>{translate(#Name#)}</th>
        <th>{translate(#Edit#)}</th>
    </tr>
    <tr class="{switchRowClass()}" flexy:foreach="aPagedData[data],key,aValue">
        <td align="center"><input class="noBorder" type="checkbox" name="frmDelete[]" value="{aValue[permission_id]}" /></td>
        <td>{aValue[permission_id]}</td>
        <td>{aValue[name]}</td>
        <td align="center"><a href="{makeUrl(#edit#,#permission#,#user#,aPagedData[data],#frmPermId|permission_id#,key)}">
            <img src="{webRoot}/themes/{theme}/images/edit.gif" alt="{translate(#edit#)}" /></a>
        </td>
    </tr>
    <tr>
        <td colspan="5">
        {translate(#With selected permission(s)#)}: 
        <input type="submit" name="delete" value="{translate(#delete#)}" 
            onClick="return confirmSubmit('{translate(#permission#)}', 'perms')" />
        </td>
    </tr>
</table>
</form>
